<?php
mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);

function make_connection($database_name) {
    return new mysqli(
        'db',  // Docker container name
        getenv('MYSQL_USER'), 
        getenv('MYSQL_PASSWORD'), 
        $database_name
    );
}

// Establish the database connection
$mysqli = make_connection("mydatabase");

// Check connection
if ($mysqli->connect_error) {
    die("Connection failed: " . $mysqli->connect_error);
}

// Assign the connection to the global variable
$GLOBALS["___mysqli_ston"] = $mysqli;
?>

